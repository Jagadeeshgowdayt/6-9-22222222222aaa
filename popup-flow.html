<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TestPaY - Popup Payment Flow</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #00C851;
            --primary-dark: #00A043;
            --secondary-color: #2563eb;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --bg-light: #f8fafc;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 8px 25px rgba(0,0,0,0.15);
            --shadow-xl: 0 20px 60px rgba(0,0,0,0.2);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 200, 255, 0.2) 0%, transparent 50%);
            animation: backgroundShift 15s ease-in-out infinite;
        }

        @keyframes backgroundShift {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        /* Main Landing Page - Now as App Launcher */
        .landing-container {
            text-align: center;
            color: white;
            max-width: 600px;
            width: 100%;
            z-index: 1;
            position: relative;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            box-shadow: var(--shadow-xl);
            animation: logoFloat 3s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .logo i {
            font-size: 32px;
            color: var(--primary-color);
        }

        .main-title {
            font-size: 52px;
            font-weight: 800;
            margin-bottom: 16px;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #ffffff, #e2e8f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-subtitle {
            font-size: 22px;
            opacity: 0.95;
            margin-bottom: 48px;
            line-height: 1.6;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .app-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .feature-card-landing {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: var(--transition);
        }

        .feature-card-landing:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .feature-card-landing i {
            font-size: 32px;
            color: var(--primary-color);
            margin-bottom: 12px;
            display: block;
        }

        .feature-card-landing h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .feature-card-landing p {
            font-size: 14px;
            opacity: 0.8;
            line-height: 1.4;
        }

        .trigger-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 18px 36px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .trigger-button:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0, 200, 81, 0.4);
        }

        .trigger-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 2s ease infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Popup Overlay - Now the main app interface */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .popup-overlay.show {
            display: flex;
            opacity: 1;
        }

        /* Popup Container - The main app window */
        .popup-container {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 32px;
            width: 100%;
            max-width: 460px;
            max-height: 85vh;
            overflow: hidden;
            box-shadow: 
                0 25px 80px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            transform: scale(0.7) translateY(50px);
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .popup-overlay.show .popup-container {
            transform: scale(1) translateY(0);
        }

        /* App window decorations */
        .popup-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
            z-index: 1;
        }

        /* Popup Header */
        .popup-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 24px 32px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .popup-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: headerShine 3s infinite;
        }

        @keyframes headerShine {
            0% { left: -100%; }
            50% { left: 100%; }
            100% { left: 100%; }
        }

        .popup-title {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 1;
            position: relative;
        }

        .popup-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 8px;
            z-index: 1;
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 2;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            margin-top: 16px;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 2px;
            transition: width 0.5s ease;
            width: 33.33%;
        }

        /* Popup Content */
        .popup-content {
            flex: 1;
            overflow-y: auto;
            padding: 0;
            background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
            position: relative;
        }

        .popup-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0,0,0,0.1), transparent);
        }

        .popup-content::-webkit-scrollbar {
            width: 6px;
        }

        .popup-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .popup-content::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.1);
            border-radius: 3px;
        }

        .popup-content::-webkit-scrollbar-thumb:hover {
            background: rgba(0,0,0,0.2);
        }

        /* Page Styles inside Popup - Enhanced App-like pages */
        .popup-page {
            display: none;
            padding: 32px;
            min-height: 450px;
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .popup-page.active {
            display: block;
            opacity: 1;
            transform: translateX(0);
        }

        /* Product Page Styles */
        .product-showcase {
            text-align: center;
            margin-bottom: 24px;
        }

        .product-image {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            border-radius: 24px;
            margin: 0 auto 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: productPulse 2s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }

        @keyframes productPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .product-image::after {
            content: '';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: sparkle 1.5s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); }
        }

        .product-icon {
            font-size: 48px;
            color: white;
        }

        .product-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .product-desc {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .price-section {
            background: var(--bg-light);
            border-radius: var(--border-radius);
            padding: 16px;
            margin-bottom: 20px;
            text-align: center;
            border: 2px solid var(--border-color);
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .price-row:last-child {
            margin-bottom: 0;
            font-weight: 700;
            font-size: 18px;
            color: var(--primary-color);
            border-top: 1px solid var(--border-color);
            padding-top: 8px;
            margin-top: 8px;
        }

        .original-price {
            text-decoration: line-through;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .feature-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            transition: var(--transition);
        }

        .feature-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .feature-icon {
            color: var(--primary-color);
            font-size: 20px;
            margin-bottom: 8px;
        }

        .feature-text {
            font-size: 12px;
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Payment Page Styles */
        .order-summary {
            background: var(--bg-light);
            border-radius: var(--border-radius);
            padding: 16px;
            margin-bottom: 20px;
        }

        .summary-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .summary-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .summary-details h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .summary-details p {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .payment-methods {
            display: grid;
            gap: 12px;
            margin-bottom: 24px;
        }

        .payment-option {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .payment-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s;
        }

        .payment-option:hover::before {
            left: 100%;
        }

        .payment-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .payment-option.selected {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            transform: scale(1.02);
        }

        .payment-option.recommended::before {
            content: 'Recommended';
            position: absolute;
            top: -8px;
            right: 12px;
            background: linear-gradient(135deg, #FBBF24, #F59E0B);
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: badgePulse 2s ease-in-out infinite;
            z-index: 2;
        }

        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .payment-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .payment-icon.upi {
            background: linear-gradient(135deg, #FF9500, #FF6B00);
        }

        .payment-icon.card {
            background: linear-gradient(135deg, #007AFF, #0051D5);
        }

        .payment-icon.wallet {
            background: linear-gradient(135deg, #32D74B, #248A3D);
        }

        .payment-icon.bank {
            background: linear-gradient(135deg, #5856D6, #3634A3);
        }

        .payment-info {
            flex: 1;
        }

        .payment-info h4 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .payment-info p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .payment-badge {
            background: linear-gradient(135deg, #34D399, #10B981);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .upi-icon { background: linear-gradient(135deg, #ff6b35, #f7931e); }
        .card-icon { background: linear-gradient(135deg, #1a1f71, #eb001b); }
        .wallet-icon { background: linear-gradient(135deg, #00baf2, #d32f2f); }

        .payment-info {
            flex: 1;
        }

        .payment-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .payment-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* UPI Apps Grid */
        .upi-apps {
            display: flex !important;
            flex-direction: row !important;
            justify-content: space-around;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            flex-wrap: nowrap !important;
            width: 100%;
            box-sizing: border-box;
        }

        /* UPI App Links Enhancement */
        .upi-app {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-decoration: none;
            display: inline-block !important;
            width: 90px;
            flex: 1 1 auto;
            max-width: 110px;
            min-width: 80px;
            box-sizing: border-box;
        }

        .upi-app::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .upi-app:hover::before {
            opacity: 0.1;
        }

        .upi-app:hover {
            border-color: var(--primary-color);
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
            text-decoration: none;
        }

        .upi-app.selected {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.05);
        }

        .upi-app-icon {
            width: 40px;
            height: 40px;
            margin: 0 auto 8px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            position: relative;
            z-index: 2;
        }

        .upi-app-icon.gpay {
            background: linear-gradient(135deg, #4285f4, #34a853);
        }

        .upi-app-icon.phonepe {
            background: linear-gradient(135deg, #5f259f, #7c4dff);
        }

        .upi-app-icon.paytm {
            background: linear-gradient(135deg, #00baf2, #0082c8);
        }

        .upi-app-icon.bhim {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
        }

        .upi-app-name {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            position: relative;
            z-index: 2;
        }

        .shine-circle {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3), transparent);
            border-radius: 50%;
            transform: scale(0);
            transition: transform 0.6s ease;
        }

        .upi-app:hover .shine-circle {
            transform: scale(1);
        }

        @keyframes shakeApp {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        /* Additional UPI Payment Button */
        .upi-payment-section {
            margin: 20px 0;
        }

        .upi-pay-button {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 16px;
            padding: 20px 24px;
            color: white;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .upi-pay-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .upi-pay-button:hover::before {
            left: 100%;
        }

        .upi-pay-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
            text-decoration: none;
            color: white;
        }

        .upi-button-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            font-size: 24px;
        }

        .upi-button-content {
            flex: 1;
            text-align: left;
        }

        .upi-button-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .upi-button-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .upi-button-arrow {
            font-size: 18px;
            opacity: 0.8;
            transition: transform 0.3s ease;
        }

        .upi-pay-button:hover .upi-button-arrow {
            transform: translateX(4px);
        }

        /* Show QR Code Button */
        .show-qr-section {
            margin: 20px 0;
        }

        .show-qr-button {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 16px;
            padding: 18px 24px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
            width: 100%;
            text-align: left;
        }

        .show-qr-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .show-qr-button:hover::before {
            left: 100%;
        }

        .show-qr-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }

        .show-qr-button.active {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.3);
        }

        .qr-button-icon {
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            font-size: 20px;
        }

        .qr-button-content {
            flex: 1;
            text-align: left;
        }

        .qr-button-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .qr-button-subtitle {
            font-size: 13px;
            opacity: 0.9;
        }

        .qr-button-arrow {
            font-size: 16px;
            opacity: 0.8;
            transition: transform 0.3s ease;
        }

        .show-qr-button:hover .qr-button-arrow {
            transform: translateY(2px);
        }

        .show-qr-button.active .qr-button-arrow {
            transform: rotate(180deg);
        }

        /* QR Section Animation */
        .qr-section {
            transition: all 0.5s ease;
            transform: translateY(-20px);
        }

        .qr-section.show {
            display: block !important;
            opacity: 1 !important;
            transform: translateY(0);
        }

        /* Enhanced floating coins animation */
        .floating-elements {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .floating-coin {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border-radius: 50%;
            animation: floatCoin 6s ease-in-out infinite;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .floating-coin::before {
            content: '₹';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: #b8860b;
            font-size: 14px;
        }

        .floating-coin:nth-child(1) {
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .floating-coin:nth-child(2) {
            top: 40%;
            right: 15%;
            animation-delay: 2s;
        }

        .floating-coin:nth-child(3) {
            bottom: 30%;
            left: 20%;
            animation-delay: 4s;
        }

        @keyframes floatCoin {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg); 
                opacity: 0.7; 
            }
            25% { 
                transform: translateY(-20px) rotate(90deg); 
                opacity: 1; 
            }
            50% { 
                transform: translateY(-10px) rotate(180deg); 
                opacity: 0.8; 
            }
            75% { 
                transform: translateY(-15px) rotate(270deg); 
                opacity: 1; 
            }
        }

        /* Particle background enhancement */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(102, 126, 234, 0.6);
            border-radius: 50%;
            animation: particleMove 15s linear infinite;
        }

        @keyframes particleMove {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-10vh) translateX(100px);
                opacity: 0;
            }
        }

        .upi-app-icon {
            width: 40px;
            height: 40px;
            margin: 0 auto 8px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
            position: relative;
            z-index: 1;
        }

        .upi-app-icon.gpay {
            background: linear-gradient(135deg, #4285F4, #34A853, #FBBC05, #EA4335);
        }

        .upi-app-icon.phonepe {
            background: linear-gradient(135deg, #5F259F, #3C1A78);
        }

        .upi-app-icon.paytm {
            background: linear-gradient(135deg, #002970, #00BAF2);
        }

        .upi-app-icon.bhim {
            background: linear-gradient(135deg, #FF9500, #FF6B00);
        }

        .upi-app-name {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-dark);
            position: relative;
            z-index: 1;
        }

        /* Enhanced Form Styling */
        .merchant-form {
            background: var(--bg-light);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            font-size: 16px;
            font-family: inherit;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            position: relative;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .form-input::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        /* Security Info */
        .security-info {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            flex: 1;
            min-width: 140px;
            justify-content: center;
            animation: securityPulse 3s ease-in-out infinite;
        }

        @keyframes securityPulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3); 
            }
            50% { 
                transform: scale(1.02); 
                box-shadow: 0 4px 16px rgba(16, 185, 129, 0.4); 
            }
        }

        .security-badge i {
            font-size: 14px;
        }

        .payment-desc {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* Verification Page Styles */
        .verification-status {
            text-align: center;
            padding: 20px 0;
        }

        .status-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 32px;
            color: white;
            animation: iconPulse 2s ease-in-out infinite;
        }

        .status-icon.verifying {
            background: var(--warning-color);
        }

        .status-icon.success {
            background: var(--success-color);
            animation: successPop 0.6s ease;
        }

        @keyframes iconPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes successPop {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f39c12;
            animation: confettiFall 3s ease-out forwards;
        }

        .confetti-piece:nth-child(odd) {
            background: #e74c3c;
            border-radius: 50%;
        }

        .confetti-piece:nth-child(3n) {
            background: #3498db;
            transform: rotate(45deg);
        }

        .confetti-piece:nth-child(4n) {
            background: #2ecc71;
        }

        .confetti-piece:nth-child(5n) {
            background: #9b59b6;
            border-radius: 50%;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Shining Circle Animation for UPI Apps */
        .shine-circle {
            position: absolute;
            top: -2px;
            right: -2px;
            width: 12px;
            height: 12px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border-radius: 50%;
            animation: shineRotate 2s linear infinite;
        }

        /* QR Code Section */
        .qr-section {
            background: linear-gradient(135deg, #f8fafc, #ffffff);
            border: 1px solid #e2e8f0;
            border-radius: 24px;
            padding: 32px 24px;
            margin: 20px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
        }

        .qr-section::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #667eea, #764ba2, #667eea, #764ba2);
            border-radius: 26px;
            z-index: -1;
            animation: qrBorderRotate 4s linear infinite;
            opacity: 0.3;
        }

        @keyframes qrBorderRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .qr-container {
            position: relative;
            z-index: 2;
        }

        .qr-header {
            margin-bottom: 24px;
        }

        .qr-title {
            font-size: 20px;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 8px;
        }

        .qr-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .qr-code-wrapper {
            display: flex;
            justify-content: center;
            margin: 24px 0;
        }

        .qr-code {
            width: 220px;
            height: 220px;
            background: #ffffff;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            border: 2px solid #f1f5f9;
        }

        .qr-image {
            width: 180px;
            height: 180px;
            border-radius: 12px;
            position: relative;
            z-index: 3;
        }

        .qr-scanner-frame {
            position: absolute;
            top: 15px;
            left: 15px;
            right: 15px;
            bottom: 15px;
            pointer-events: none;
            z-index: 4;
        }

        .qr-corner {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid #667eea;
            border-radius: 3px;
        }

        .qr-corner-tl {
            top: 0;
            left: 0;
            border-right: none;
            border-bottom: none;
            animation: cornerPulse 2s ease-in-out infinite;
        }

        .qr-corner-tr {
            top: 0;
            right: 0;
            border-left: none;
            border-bottom: none;
            animation: cornerPulse 2s ease-in-out infinite 0.5s;
        }

        .qr-corner-bl {
            bottom: 0;
            left: 0;
            border-right: none;
            border-top: none;
            animation: cornerPulse 2s ease-in-out infinite 1s;
        }

        .qr-corner-br {
            bottom: 0;
            right: 0;
            border-left: none;
            border-top: none;
            animation: cornerPulse 2s ease-in-out infinite 1.5s;
        }

        .qr-scanline {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #667eea, transparent);
            animation: scanlineMove 3s ease-in-out infinite;
        }

        @keyframes cornerPulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        @keyframes scanlineMove {
            0% { top: 0; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: calc(100% - 2px); opacity: 0; }
        }

        .qr-details {
            margin: 24px 0;
            padding: 16px;
            background: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .qr-amount {
            font-size: 24px;
            font-weight: 700;
            color: #059669;
            margin-bottom: 8px;
        }

        .qr-upi {
            font-size: 14px;
            color: #475569;
            margin-bottom: 4px;
            font-weight: 500;
        }

        .qr-ref {
            font-size: 12px;
            color: #64748b;
            font-family: 'Courier New', monospace;
        }

        .qr-timer {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            animation: timerPulse 2s ease-in-out infinite;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
        }

        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .status-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .status-desc {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .timer-display {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid var(--warning-color);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 600;
            color: var(--warning-color);
        }

        .transaction-details {
            background: var(--bg-light);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .detail-row:last-child {
            margin-bottom: 0;
            font-weight: 600;
            border-top: 1px solid var(--border-color);
            padding-top: 8px;
        }

        .detail-label {
            color: var(--text-secondary);
        }

        .detail-value {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Popup Footer */
        .popup-footer {
            padding: 20px 24px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-light);
        }

        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
            min-height: 56px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.5);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            color: var(--secondary-color);
            border: 2px solid var(--secondary-color);
            margin-top: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, var(--secondary-color), #1e40af);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(37, 99, 235, 0.3);
        }

        .btn-loading {
            pointer-events: none;
            opacity: 0.7;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-primary);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            z-index: 10001;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .toast.show {
            opacity: 1;
        }

        .toast.success {
            background: var(--success-color);
        }

        .toast.error {
            background: var(--error-color);
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .popup-container {
                max-width: 95vw;
                max-height: 95vh;
                margin: 10px;
            }

            .popup-page {
                padding: 20px;
            }

            .main-title {
                font-size: 36px;
            }

            .main-subtitle {
                font-size: 18px;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            /* Force horizontal UPI apps on mobile */
            .upi-apps {
                display: flex !important;
                flex-direction: row !important;
                flex-wrap: nowrap !important;
                justify-content: space-around !important;
                gap: 10px !important;
                padding: 15px !important;
            }

            .upi-app {
                display: inline-block !important;
                width: 70px !important;
                min-width: 70px !important;
                max-width: 80px !important;
                padding: 8px 4px !important;
                flex: 1 1 auto !important;
            }

            .upi-app-name {
                font-size: 11px !important;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Confetti Effect */
        .confetti {
            position: fixed;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 10002;
            animation: confettiFall 3s linear forwards;
        }

        @keyframes confettiFall {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) rotate(720deg);
            }
        }
    </style>
</head>
<body>
    <!-- Main Landing Page -->
    <div class="landing-container">
        <!-- Floating Background Elements -->
        <div class="floating-elements">
            <div class="floating-coin"></div>
            <div class="floating-coin"></div>
            <div class="floating-coin"></div>
        </div>
        
        <!-- Particles Background -->
        <div class="particles" id="particles"></div>
        
        <div class="logo">
            <i class="fas fa-heart"></i>
        </div>
        <h1 class="main-title">TestPaY</h1>
        <p class="main-subtitle">Making payments simple, secure, and fast.<br>Join thousands who trust TestPaY.</p>
        <button class="trigger-button" onclick="openPaymentPopup()">
            <i class="fas fa-gift" style="margin-right: 8px;"></i>
            Start Donation
        </button>
    </div>

    <!-- Payment Popup Overlay -->
    <div class="popup-overlay" id="paymentPopup">
        <div class="popup-container">
            <!-- Popup Header -->
            <div class="popup-header">
                <div class="popup-title" id="popupTitle">Make Payment</div>
                <div class="popup-subtitle" id="popupSubtitle">Complete your payment</div>
                <button class="close-btn" onclick="closePaymentPopup()">
                    <i class="fas fa-times"></i>
                </button>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <!-- Popup Content -->
            <div class="popup-content">
                <!-- Page 1: Merchant Setup -->
                <div class="popup-page active" id="page-1">
                    <div class="product-showcase">
                        <div class="product-image">
                            <div class="product-icon">
                                <i class="fas fa-store"></i>
                            </div>
                        </div>
                        <h2 class="product-title">Setup Payment Details</h2>
                        <p class="product-desc">Configure your merchant payment information</p>
                    </div>

                    <div class="merchant-form">
                        <div class="form-group">
                            <label for="merchantName">Merchant/Receiver Name</label>
                            <input type="text" id="merchantName" class="form-input" placeholder="Enter merchant name" value="TestPaY">
                        </div>

                        <div class="form-group">
                            <label for="upiId">UPI ID</label>
                            <input type="text" id="upiId" class="form-input" placeholder="example@upi" value="india@ibl">
                        </div>

                        <div class="form-group">
                            <label for="paymentAmount">Amount (₹)</label>
                            <input type="number" id="paymentAmount" class="form-input" placeholder="Enter amount" value="1" min="1" max="100000">
                        </div>

                        <div class="form-group">
                            <label for="customMessage">Custom Message/Reference</label>
                            <input type="text" id="customMessage" class="form-input" placeholder="Payment reference or message" value="#4486474537453">
                        </div>
                    </div>

                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="feature-text">100% Secure</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="feature-text">Instant Process</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-qrcode"></i>
                            </div>
                            <div class="feature-text">QR Code Ready</div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div class="feature-text">UPI Compatible</div>
                        </div>
                    </div>
                </div>

                <!-- Page 2: Payment -->
                <div class="popup-page" id="page-2">
                    <div class="order-summary">
                        <div class="summary-item">
                            <div class="summary-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <div class="summary-details">
                                <h4 id="summaryMerchantName">TestPaY</h4>
                                <p id="summaryAmount">₹1</p>
                            </div>
                        </div>
                    </div>

                    <!-- Show QR Code Button - At Top -->
                    <div class="show-qr-section">
                        <button class="show-qr-button" onclick="toggleQRCode()" id="showQRButton">
                            <div class="qr-button-icon">
                                <i class="fas fa-qrcode"></i>
                            </div>
                            <div class="qr-button-content">
                                <div class="qr-button-title">Show UPI QR Code</div>
                                <div class="qr-button-subtitle">Scan to pay instantly</div>
                            </div>
                            <div class="qr-button-arrow">
                                <i class="fas fa-chevron-down" id="qrArrow"></i>
                            </div>
                        </button>
                    </div>

                    <!-- QR Code Section - Initially Hidden, Controlled by Button -->
                    <div class="qr-section" id="qrSection" style="display: none; opacity: 0;">
                        <div class="qr-container">
                            <div class="qr-header">
                                <div class="qr-title">Scan QR Code to Pay</div>
                                <div class="qr-subtitle">Open any UPI app to pay ₹1</div>
                            </div>
                            
                            <div class="qr-code-wrapper">
                                <div class="qr-code" id="qrCode">
                                    <div class="qr-scanner-frame">
                                        <div class="qr-corner qr-corner-tl"></div>
                                        <div class="qr-corner qr-corner-tr"></div>
                                        <div class="qr-corner qr-corner-bl"></div>
                                        <div class="qr-corner qr-corner-br"></div>
                                        <div class="qr-scanline"></div>
                                    </div>
                                    <img id="qrCodeImage" src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=upi://pay?pa=india@ibl%26pn=TestPaY%26am=1%26cu=INR%26tn=%234486474537453" 
                                         alt="UPI QR Code" class="qr-image">
                                </div>
                            </div>
                            
                            <div class="qr-details">
                                <div class="qr-amount">₹1</div>
                                <div class="qr-upi">UPI: india@ibl</div>
                                <div class="qr-ref">Ref: #4486474537453</div>
                            </div>
                            
                            <div class="qr-timer" id="qrTimer">
                                <i class="fas fa-clock"></i>
                                Valid for <span id="qrCountdown">5:00</span>
                            </div>
                        </div>
                    </div>

                    <!-- UPI Apps Section -->
                    <div class="upi-apps" id="upiApps" style="display: block;">
                        <a href="#" class="upi-app selected" data-app="gpay" onclick="selectUPIApp('gpay', event)" id="gpayLink">
                            <div class="upi-app-icon gpay">
                                <i class="fab fa-google-pay"></i>
                            </div>
                            <div class="upi-app-name">GPay</div>
                            <div class="shine-circle"></div>
                        </a>

                        <a href="#" class="upi-app" data-app="phonepe" onclick="selectUPIApp('phonepe', event)" id="phonepeLink">
                            <div class="upi-app-icon phonepe">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div class="upi-app-name">PhonePe</div>
                            <div class="shine-circle"></div>
                        </a>

                        <a href="#" class="upi-app" data-app="paytm" onclick="selectUPIApp('paytm', event)" id="paytmLink">
                            <div class="upi-app-icon paytm">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="upi-app-name">Paytm</div>
                            <div class="shine-circle"></div>
                        </a>
                    </div>

                    <!-- Additional UPI Payment Button -->
                    <div class="upi-payment-section">
                        <a href="#" class="upi-pay-button" onclick="openUPIApp(event)" id="generalUPIButton">
                            <div class="upi-button-icon">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div class="upi-button-content">
                                <div class="upi-button-title">Pay using any UPI app</div>
                                <div class="upi-button-subtitle">Quick & Secure Payment</div>
                            </div>
                            <div class="upi-button-arrow">
                                <i class="fas fa-chevron-right"></i>
                            </div>
                        </a>
                    </div>

                </div>

                <!-- Page 3: Verification -->
                <div class="popup-page" id="page-3">
                    <div class="verification-status">
                        <div class="status-icon verifying" id="statusIcon">
                            <i class="fas fa-clock" id="statusIconContent"></i>
                        </div>
                        <h3 class="status-title" id="statusTitle">Verifying Payment</h3>
                        <p class="status-desc" id="statusDesc">Please wait while we confirm your payment. This usually takes a few seconds.</p>
                        
                        <div class="timer-display" id="timerDisplay">
                            <i class="fas fa-hourglass-half"></i>
                            <span>Please wait </span>
                            <span id="timer">15</span>
                            <span> seconds</span>
                        </div>
                    </div>

                    <div class="transaction-details">
                        <div class="detail-row">
                            <span class="detail-label">Transaction ID</span>
                            <span class="detail-value" id="transactionId">CJ2025090687451</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Payment Method</span>
                            <span class="detail-value" id="paymentMethodUsed">UPI Payment</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Date & Time</span>
                            <span class="detail-value" id="paymentDateTime"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Amount</span>
                            <span class="detail-value">₹1.00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Popup Footer -->
            <div class="popup-footer">
                <button class="btn btn-primary" id="primaryBtn" onclick="handlePrimaryAction()">
                    <i class="fas fa-heart"></i>
                    <span id="primaryBtnText">Donate Now - ₹1</span>
                </button>
                <button class="btn btn-secondary" id="secondaryBtn" onclick="handleSecondaryAction()" style="display: none;">
                    <i class="fas fa-times"></i>
                    <span id="secondaryBtnText">Cancel Transaction</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
        // Global State
        let currentPopupPage = 1;
        let selectedPaymentMethod = 'upi';
        let selectedUPIApp = 'UPI App'; // Track which UPI app was selected
        let paymentStartTime = null; // Track when payment was initiated
        let verificationTimer = null;
        let verificationTime = 15;

        // Configuration
        const CONFIG = {
            amount: 1,
            merchantName: 'TestPaY',
            upiId: 'india@ibl',
            customMessage: '#4486474537453',
            transactionPrefix: 'CJ',
            paymentMethods: {
                upi: 'UPI Payment'
            },
            pageConfig: {
                1: {
                    title: 'Setup Payment',
                    subtitle: 'Configure merchant details',
                    progress: 33.33
                },
                2: {
                    title: 'Choose Payment',
                    subtitle: 'Select payment method',
                    progress: 66.66
                },
                3: {
                    title: 'Payment Status',
                    subtitle: 'Confirming transaction',
                    progress: 100
                }
            }
        };

        // Popup Management
        function openPaymentPopup() {
            const popup = document.getElementById('paymentPopup');
            popup.classList.add('show');
            document.body.style.overflow = 'hidden';
            
            // Initialize popup features
            startQRTimer();
            
            // Update UPI links with current config
            updateUPILinks();
            updateQRCode();
            
            // Reset to page 1
            goToPopupPage(1);
            showToast('Welcome to TestPaY!', 'success');
        }

        function closePaymentPopup() {
            const popup = document.getElementById('paymentPopup');
            popup.classList.remove('show');
            document.body.style.overflow = 'auto';
            
            // Clean up timers
            if (qrTimer) {
                clearInterval(qrTimer);
                qrTimer = null;
            }
            
            // Reset state
            resetPopupState();
        }

        function resetPopupState() {
            currentPopupPage = 1;
            selectedPaymentMethod = 'upi';
            selectedUPIApp = 'UPI App';
            paymentStartTime = null;
            if (verificationTimer) {
                clearInterval(verificationTimer);
                verificationTimer = null;
            }
            verificationTime = 15;
            qrTimeRemaining = 300;
            
            // Reset UI elements
            document.querySelectorAll('.popup-page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById('page-1').classList.add('active');
            
            document.getElementById('primaryBtn').classList.remove('btn-loading');
            document.getElementById('primaryBtnText').textContent = `Continue with ₹${CONFIG.amount}`;
            document.getElementById('secondaryBtn').style.display = 'none';
        }

        // Page Navigation within Popup
        function goToPopupPage(pageNumber) {
            // Validate and update payment details when moving from page 1 to page 2
            if (currentPopupPage === 1 && pageNumber === 2) {
                if (!updatePaymentDetails()) {
                    return; // Don't proceed if validation fails
                }
            }

            // Hide all pages
            document.querySelectorAll('.popup-page').forEach(page => {
                page.classList.remove('active');
            });

            // Show target page
            setTimeout(() => {
                document.getElementById(`page-${pageNumber}`).classList.add('active');
            }, 150);

            // Update header and progress
            const config = CONFIG.pageConfig[pageNumber];
            document.getElementById('popupTitle').textContent = config.title;
            document.getElementById('popupSubtitle').textContent = config.subtitle;
            document.getElementById('progressFill').style.width = config.progress + '%';

            currentPopupPage = pageNumber;

            // Update footer buttons
            updateFooterButtons(pageNumber);

            // Page-specific initialization
            if (pageNumber === 3) {
                startVerification();
            }
        }

        function updateFooterButtons(pageNumber) {
            const primaryBtn = document.getElementById('primaryBtn');
            const secondaryBtn = document.getElementById('secondaryBtn');
            const primaryBtnText = document.getElementById('primaryBtnText');
            const secondaryBtnText = document.getElementById('secondaryBtnText');

            switch (pageNumber) {
                case 1:
                    primaryBtnText.textContent = `Continue with ₹${CONFIG.amount}`;
                    primaryBtn.querySelector('i').className = 'fas fa-arrow-right';
                    secondaryBtn.style.display = 'none';
                    break;
                case 2:
                    primaryBtnText.textContent = `Paid Successfully via ${getSelectedPaymentModeName()}`;
                    primaryBtn.querySelector('i').className = 'fas fa-check-circle';
                    secondaryBtn.style.display = 'none';
                    break;
                case 3:
                    primaryBtnText.textContent = 'Processing...';
                    primaryBtn.querySelector('i').className = 'fas fa-clock';
                    secondaryBtn.style.display = 'block';
                    secondaryBtnText.textContent = 'Cancel Transaction';
                    secondaryBtn.querySelector('i').className = 'fas fa-times';
                    break;
            }
        }

        // Update Payment Details from Form
        function updatePaymentDetails() {
            const merchantName = document.getElementById('merchantName').value.trim();
            const upiId = document.getElementById('upiId').value.trim();
            const amount = document.getElementById('paymentAmount').value.trim();
            const customMessage = document.getElementById('customMessage').value.trim();

            // Validation
            if (!merchantName) {
                showToast('Please enter merchant name', 'error');
                return false;
            }
            if (!upiId || !upiId.includes('@')) {
                showToast('Please enter a valid UPI ID', 'error');
                return false;
            }
            if (!amount || amount <= 0) {
                showToast('Please enter a valid amount', 'error');
                return false;
            }

            // Update global config
            CONFIG.merchantName = merchantName;
            CONFIG.upiId = upiId;
            CONFIG.amount = parseFloat(amount);
            CONFIG.customMessage = customMessage;

            // Update all UPI links and QR code
            updateUPILinks();
            updateQRCode();
            updateDisplayAmounts();

            showToast('Payment details updated successfully!', 'success');
            return true;
        }

        // Update UPI Links
        function updateUPILinks() {
            const baseUPIUrl = `upi://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.merchantName)}&am=${CONFIG.amount}&cu=INR&tn=${encodeURIComponent(CONFIG.customMessage)}`;
            
            // Update specific UPI app links with correct schemes
            const gpayLink = document.getElementById('gpayLink');
            const phonepeLink = document.getElementById('phonepeLink');
            const paytmLink = document.getElementById('paytmLink');
            const generalUPIButton = document.getElementById('generalUPIButton');
            
            if (gpayLink) {
                gpayLink.href = `gpay://upi/pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.merchantName)}&am=${CONFIG.amount}&cu=INR&tn=${encodeURIComponent(CONFIG.customMessage)}`;
            }
            
            if (phonepeLink) {
                phonepeLink.href = `phonepe://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.merchantName)}&am=${CONFIG.amount}&cu=INR&tn=${encodeURIComponent(CONFIG.customMessage)}`;
            }
            
            if (paytmLink) {
                paytmLink.href = `paytmmp://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.merchantName)}&am=${CONFIG.amount}&cu=INR&tn=${encodeURIComponent(CONFIG.customMessage)}`;
            }
            
            if (generalUPIButton) {
                generalUPIButton.href = baseUPIUrl;
            }
        }

        // Update QR Code
        function updateQRCode() {
            const qrData = `upi://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.merchantName)}&am=${CONFIG.amount}&cu=INR&tn=${encodeURIComponent(CONFIG.customMessage)}`;
            const qrImage = document.getElementById('qrCodeImage');
            if (qrImage) {
                qrImage.src = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(qrData)}`;
            }

            // Update QR details
            const qrAmount = document.querySelector('.qr-amount');
            const qrUpi = document.querySelector('.qr-upi');
            const qrRef = document.querySelector('.qr-ref');
            
            if (qrAmount) qrAmount.textContent = `₹${CONFIG.amount}`;
            if (qrUpi) qrUpi.textContent = `UPI: ${CONFIG.upiId}`;
            if (qrRef) qrRef.textContent = `Ref: ${CONFIG.customMessage}`;
        }

        // Update Display Amounts
        function updateDisplayAmounts() {
            // Update summary details
            const summaryMerchantName = document.getElementById('summaryMerchantName');
            const summaryAmount = document.getElementById('summaryAmount');
            
            if (summaryMerchantName) summaryMerchantName.textContent = CONFIG.merchantName;
            if (summaryAmount) summaryAmount.textContent = `₹${CONFIG.amount}`;

            // Update button text
            const primaryBtnText = document.getElementById('primaryBtnText');
            if (primaryBtnText && currentPopupPage === 1) {
                primaryBtnText.textContent = `Continue with ₹${CONFIG.amount}`;
            }
        }

        // Get Selected Payment Mode Name
        function getSelectedPaymentModeName() {
            if (selectedUPIApp !== 'UPI App') {
                return selectedUPIApp;
            }
            return 'UPI';
        }

        // Check Payment Status and Show Countdown
        function checkPaymentStatus() {
            if (!paymentStartTime) return 'No payment initiated';
            
            const timeSincePayment = Date.now() - paymentStartTime;
            const oneMinute = 60 * 1000;
            
            if (timeSincePayment >= oneMinute) {
                return 'Payment time elapsed';
            } else {
                const remainingSeconds = Math.ceil((oneMinute - timeSincePayment) / 1000);
                return `Wait ${remainingSeconds}s or complete payment`;
            }
        }

        // Update Payment Status Display
        function updatePaymentStatusDisplay() {
            // Timer functionality is hidden - no visual countdown on button
            // Only used internally for validation
            if (currentPopupPage === 2 && paymentStartTime) {
                const timeSincePayment = Date.now() - paymentStartTime;
                const oneMinute = 60 * 1000;
                
                if (timeSincePayment < oneMinute) {
                    // Keep original button text without timer
                    document.getElementById('primaryBtnText').textContent = `Paid Successfully via ${getSelectedPaymentModeName()}`;
                    
                    // Schedule next update (for internal tracking only)
                    setTimeout(updatePaymentStatusDisplay, 1000);
                } else {
                    // Timer finished, keep normal text
                    document.getElementById('primaryBtnText').textContent = `Paid Successfully via ${getSelectedPaymentModeName()}`;
                }
            }
        }

        // Payment Method Selection
        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            
            // Update selected state
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            document.querySelector(`[data-method="${method}"]`).classList.add('selected');
            
            // UPI apps are always visible now since we only have UPI payment
            const upiApps = document.getElementById('upiApps');
            upiApps.style.display = 'grid';
            
            showToast(`${CONFIG.paymentMethods[method]} selected`, 'success');
        }

        // UPI App Selection with Redirection
        function selectUPIApp(app, event) {
            // Track selected UPI app and payment start time
            selectedUPIApp = app.toUpperCase();
            paymentStartTime = Date.now();
            
            // Prevent default link behavior for visual feedback first
            if (event) {
                event.preventDefault();
            }
            
            // Update selected state
            document.querySelectorAll('.upi-app').forEach(appElement => {
                appElement.classList.remove('selected');
            });
            
            document.querySelector(`[data-app="${app}"]`).classList.add('selected');
            
            // Add shake animation to selected app
            const selectedApp = document.querySelector(`[data-app="${app}"]`);
            selectedApp.style.animation = 'none';
            setTimeout(() => {
                selectedApp.style.animation = 'shakeApp 0.5s ease-in-out';
            }, 10);
            
            // Update button text immediately
            updateFooterButtons(currentPopupPage);
            
            // Start payment timer display
            updatePaymentStatusDisplay();
            
            showToast(`${app.toUpperCase()} selected - Opening app...`, 'success');
            
            // Get the correct UPI link and redirect
            const selectedAppElement = document.querySelector(`[data-app="${app}"]`);
            if (selectedAppElement && selectedAppElement.href && selectedAppElement.href !== '#') {
                setTimeout(() => {
                    window.location.href = selectedAppElement.href;
                }, 1000);
            } else {
                // Fallback to general UPI scheme
                setTimeout(() => {
                    const fallbackLink = `upi://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.merchantName)}&am=${CONFIG.amount}&cu=INR&tn=${encodeURIComponent(CONFIG.customMessage)}`;
                    window.location.href = fallbackLink;
                }, 1000);
            }
        }

        // Open UPI App Function for new button
        function openUPIApp(event) {
            // Prevent default link behavior
            if (event) {
                event.preventDefault();
            }
            
            // Track that general UPI button was used and payment start time
            selectedUPIApp = 'UPI';
            paymentStartTime = Date.now();
            
            // Update button text immediately
            updateFooterButtons(currentPopupPage);
            
            // Start payment timer display
            updatePaymentStatusDisplay();
            
            showToast('Opening UPI app...', 'success');
            
            // Use dynamic UPI link from config
            const upiLink = `upi://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.merchantName)}&am=${CONFIG.amount}&cu=INR&tn=${encodeURIComponent(CONFIG.customMessage)}`;
            
            // Try to redirect to UPI app
            setTimeout(() => {
                window.location.href = upiLink;
            }, 1000);
        }

        // Toggle QR Code Display
        function toggleQRCode() {
            const qrSection = document.getElementById('qrSection');
            const button = document.getElementById('showQRButton');
            const arrow = document.getElementById('qrArrow');
            const buttonTitle = button.querySelector('.qr-button-title');
            const buttonSubtitle = button.querySelector('.qr-button-subtitle');
            
            if (qrSection.style.display === 'none' || qrSection.style.opacity === '0') {
                // Show QR Code
                qrSection.style.display = 'block';
                setTimeout(() => {
                    qrSection.style.opacity = '1';
                    qrSection.classList.add('show');
                }, 10);
                
                // Track QR code usage and payment start time
                selectedUPIApp = 'QR Code';
                paymentStartTime = Date.now();
                updateFooterButtons(currentPopupPage);
                
                // Start payment timer display
                updatePaymentStatusDisplay();
                
                // Update button
                button.classList.add('active');
                buttonTitle.textContent = 'Hide UPI QR Code';
                buttonSubtitle.textContent = 'QR code is now visible';
                arrow.className = 'fas fa-chevron-up';
                
                // Start QR timer
                startQRTimer();
                
                showToast('QR Code displayed!', 'success');
            } else {
                // Hide QR Code
                qrSection.classList.remove('show');
                qrSection.style.opacity = '0';
                setTimeout(() => {
                    qrSection.style.display = 'none';
                }, 500);
                
                // Reset tracking when hidden
                selectedUPIApp = 'UPI App';
                updateFooterButtons(currentPopupPage);
                
                // Update button
                button.classList.remove('active');
                buttonTitle.textContent = 'Show UPI QR Code';
                buttonSubtitle.textContent = 'Scan to pay instantly';
                arrow.className = 'fas fa-chevron-down';
                
                // Stop QR timer
                if (qrTimer) {
                    clearInterval(qrTimer);
                }
                
                showToast('QR Code hidden', 'info');
            }
        }

        // QR Code Timer
        let qrTimer = null;
        let qrTimeRemaining = 300; // 5 minutes

        function startQRTimer() {
            const qrCountdown = document.getElementById('qrCountdown');
            
            qrTimer = setInterval(() => {
                const minutes = Math.floor(qrTimeRemaining / 60);
                const seconds = qrTimeRemaining % 60;
                qrCountdown.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                qrTimeRemaining--;
                
                if (qrTimeRemaining < 0) {
                    clearInterval(qrTimer);
                    refreshQRCode();
                }
            }, 1000);
        }

        function refreshQRCode() {
            qrTimeRemaining = 300;
            startQRTimer();
            showToast('QR Code refreshed', 'info');
        }

        // Create floating particles
        function createParticles() {
            const particles = document.getElementById('particles');
            const particleCount = 20;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particles.appendChild(particle);
            }
        }

        // Enhanced page redirect functions
        function redirectToApp(appUrl, appName) {
            showToast(`Opening ${appName}...`, 'info');
            
            // Try to open the app
            window.location.href = appUrl;
            
            // Fallback: if app doesn't open, show manual instructions
            setTimeout(() => {
                if (document.hasFocus()) {
                    showToast(`Please install ${appName} to continue`, 'warning');
                }
            }, 3000);
        }

        // Auto-redirect based on detected UPI apps
        function detectAndRedirectUPI() {
            const userAgent = navigator.userAgent.toLowerCase();
            const isAndroid = userAgent.includes('android');
            const isIOS = userAgent.includes('iphone') || userAgent.includes('ipad');
            
            if (isAndroid) {
                // Android deep links
                const androidApps = [
                    { name: 'GPay', scheme: 'upi://pay', package: 'com.google.android.apps.nbu.paisa.user' },
                    { name: 'PhonePe', scheme: 'phonepe://pay', package: 'com.phonepe.app' },
                    { name: 'Paytm', scheme: 'paytmmp://pay', package: 'net.one97.paytm' }
                ];
                
                return androidApps;
            } else if (isIOS) {
                // iOS URL schemes
                const iosApps = [
                    { name: 'GPay', scheme: 'gpay://pay' },
                    { name: 'PhonePe', scheme: 'phonepe://pay' },
                    { name: 'Paytm', scheme: 'paytm://pay' }
                ];
                
                return iosApps;
            }
            
            return [];
        }

        // Verification Process
        function startVerification() {
            // Set transaction details
            const now = new Date();
            const dateTimeString = now.toLocaleString('en-IN', {
                dateStyle: 'medium',
                timeStyle: 'short'
            });
            
            document.getElementById('paymentDateTime').textContent = dateTimeString;
            document.getElementById('paymentMethodUsed').textContent = CONFIG.paymentMethods[selectedPaymentMethod];

            // Generate transaction ID
            const transactionId = CONFIG.transactionPrefix + Date.now().toString().slice(-10);
            document.getElementById('transactionId').textContent = transactionId;

            // Start timer
            verificationTime = 15;
            verificationTimer = setInterval(() => {
                document.getElementById('timer').textContent = verificationTime;
                verificationTime--;

                if (verificationTime < 0) {
                    clearInterval(verificationTimer);
                    showSuccess();
                }
            }, 1000);
        }

        function showSuccess() {
            // Update status icon and content
            const statusIcon = document.getElementById('statusIcon');
            const statusIconContent = document.getElementById('statusIconContent');
            const statusTitle = document.getElementById('statusTitle');
            const statusDesc = document.getElementById('statusDesc');

            statusIcon.classList.remove('verifying');
            statusIcon.classList.add('success');
            statusIconContent.className = 'fas fa-check';
            statusTitle.textContent = 'Payment Successful!';
            statusDesc.textContent = 'Thank you for your donation! Your contribution will make a real difference.';

            // Hide timer
            document.getElementById('timerDisplay').style.display = 'none';

            // Update footer
            document.getElementById('primaryBtnText').textContent = 'Donate Again';
            document.getElementById('primaryBtn').querySelector('i').className = 'fas fa-heart';
            document.getElementById('secondaryBtnText').textContent = 'Close';
            document.getElementById('secondaryBtn').querySelector('i').className = 'fas fa-check';

            // Update header
            document.getElementById('popupTitle').textContent = 'Success!';
            document.getElementById('popupSubtitle').textContent = 'Payment completed';

            // Show confetti and toast
            createConfetti();
            triggerEnhancedConfetti();
            showToast('Payment successful! Thank you for your donation.', 'success');
        }

        // Enhanced Confetti Animation
        function triggerEnhancedConfetti() {
            const colors = ['#f39c12', '#e74c3c', '#3498db', '#2ecc71', '#9b59b6', '#ff6b35', '#ffd700'];
            const confettiContainer = document.body;
            
            for (let i = 0; i < 150; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.position = 'fixed';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-10px';
                    confetti.style.width = Math.random() * 10 + 5 + 'px';
                    confetti.style.height = Math.random() * 10 + 5 + 'px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.pointerEvents = 'none';
                    confetti.style.zIndex = '10000';
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0%';
                    
                    const animation = confetti.animate([
                        {
                            transform: 'translateY(-100vh) rotate(0deg)',
                            opacity: 1
                        },
                        {
                            transform: `translateY(100vh) translateX(${(Math.random() - 0.5) * 200}px) rotate(720deg)`,
                            opacity: 0
                        }
                    ], {
                        duration: Math.random() * 2000 + 3000,
                        easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                    });
                    
                    confettiContainer.appendChild(confetti);
                    
                    animation.addEventListener('finish', () => {
                        confetti.remove();
                    });
                }, i * 30);
            }
        }

        // Action Handlers
        function handlePrimaryAction() {
            const btn = document.getElementById('primaryBtn');
            
            if (currentPopupPage === 1) {
                goToPopupPage(2);
            } else if (currentPopupPage === 2) {
                // Check if payment was initiated and if enough time has passed
                if (!paymentStartTime) {
                    showToast('⚠️ Please select a payment method first!', 'error');
                    return;
                }
                
                const timeSincePayment = Date.now() - paymentStartTime;
                const oneMinute = 60 * 1000; // 60 seconds in milliseconds
                
                if (timeSincePayment < oneMinute) {
                    showToast('⚠️ Please complete payment first!', 'error');
                    return;
                }
                
                btn.classList.add('btn-loading');
                setTimeout(() => {
                    btn.classList.remove('btn-loading');
                    goToPopupPage(3);
                }, 2000);
            } else if (currentPopupPage === 3) {
                if (document.getElementById('statusTitle').textContent === 'Payment Successful!') {
                    // Restart donation flow
                    resetPopupState();
                    goToPopupPage(1);
                    showToast('Starting new donation...', 'success');
                }
            }
        }

        function handleSecondaryAction() {
            if (currentPopupPage === 3) {
                if (document.getElementById('statusTitle').textContent === 'Payment Successful!') {
                    closePaymentPopup();
                } else {
                    // Cancel transaction
                    if (confirm('Are you sure you want to cancel this transaction?')) {
                        clearInterval(verificationTimer);
                        showToast('Transaction cancelled', 'error');
                        setTimeout(() => {
                            goToPopupPage(2);
                        }, 1000);
                    }
                }
            }
        }

        // Utility Functions
        function showToast(message, type = 'default') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast';
            
            if (type !== 'default') {
                toast.classList.add(type);
            }
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function createConfetti() {
            const colors = ['#00C851', '#2563eb', '#f59e0b', '#ef4444', '#8b5cf6'];
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * window.innerWidth + 'px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 50);
            }
        }

        // Event Listeners
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closePaymentPopup();
            }
        });

        // Click outside to close
        document.getElementById('paymentPopup').addEventListener('click', (e) => {
            if (e.target.classList.contains('popup-overlay')) {
                closePaymentPopup();
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Set initial payment method
            selectPaymentMethod('upi');
            
            // Create background particles
            createParticles();
            
            // Detect available UPI apps
            const availableApps = detectAndRedirectUPI();
            console.log('Available UPI apps:', availableApps);
            
            // Initialize QR timer display
            const qrCountdown = document.getElementById('qrCountdown');
            if (qrCountdown) {
                qrCountdown.textContent = '5:00';
            }
            
            // Add enhanced click handlers for UPI apps
            document.querySelectorAll('.upi-app').forEach(app => {
                app.addEventListener('click', function(e) {
                    e.preventDefault();
                    const appName = this.dataset.app;
                    selectUPIApp(appName, e);
                });
            });
        });

        // Cleanup
        window.addEventListener('beforeunload', () => {
            if (verificationTimer) {
                clearInterval(verificationTimer);
            }
        });
    </script>
</body>
</html>
